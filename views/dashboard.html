<!DOCTYPE html>
<html>
  <head>
    <title>Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      type="text/css"
      href="bootstrap/css/bootstrap.min.css"
    />
    <link rel="stylesheet" type="text/css" href="css/main.css" />
    <script
      src="https://kit.fontawesome.com/c9cc288421.js"
      crossorigin="anonymous"
    ></script>
    <link rel="icon" href="images/logo.png" />
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"
    ></script>
    <link rel="stylesheet" type="text/css" href="css/main.css" />
    <script>
      function logout() {
        window.location.href = "/logout";
      }
      function delete_account_button() {
        // using delete request to delete the account
        if (confirm("Are you sure you want to delete your account?")) {
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
          if (this.readyState == 4 && this.status == 200) {
            window.location.href = "/";
          }
        };
        xhttp.open("DELETE", "/delete", true);
        xhttp.send();
        window.location.href = "/";
      } else {  
        return;
         }
        }

      function new_password() {
        window.location.href = "/forget";
      }

      function getEmail() {
        // get email from /info
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
          if (this.readyState == 4 && this.status == 200) {
            document.getElementById("email").innerHTML = this.responseText;
          }
        };
        xhttp.open("GET", "/getemail", true);
        xhttp.send();
      }
      function getUsername() {
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function () {
          if (this.readyState == 4 && this.status == 200) {
            document.getElementById("username").innerHTML = this.responseText;
          }
        };
        xhttp.open("GET", "/username", true);
        xhttp.send();
      }
    </script>
  </head>
  <script src="bootstrap/js/bootstrap.min.js"></script>
  <body style="background-color: #141615">
    <!--Dynamic NavBar without menu-->
    <nav class="navbar navbar-expand-lg bg-dark">
      <div class="container-fluid">
        <a class="navbar-brand text-white" href="/">SynTech</a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
              <a class="nav-link active text-white" aria-current="home" href="/"
                >Home</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link text-white" href="/blog">Blog</a>
            </li>
            <li class="nav-item">
              <a class="nav-link text-white" href="/login">Login</a>
            </li>
            <li class="nav-item">
              <a class="nav-link text-white" href="/register">Register</a>
            </li>
            <li class="nav-item">
              <a class="nav-link text-white" href="/shop">Shop</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <br />
      <div class="container mx-auto text-center">
        <div class="row">
          <div class="col-sm-12">
            <h1 class="text-white">Dashboard</h1>
          </div>
        </div>
      </div>
      <div class="container mx-auto text-center">
        <div class="row">
          <div class="col-sm-12">
            <h2 class="text-white">Welcome <span id="username"></span></h2>
            <script>
              getUsername();
            </script>
          </div>
        </div>
      </div>
      <div class="container mx-auto text-center">
        <div class="row">
          <div class="col-sm-12">
            <h3 class="text-white">Email: <span id="email"></span></h3>
            <script>
              getEmail();
            </script>
          </div>
        </div>
      </div>
      <div class="container mx-auto text-center">
        <div class="row">
          <div class="col-sm-12">
            <h3 class="text-white">
              <button class="btn btn-primary" onclick="logout()">Logout</button>
              <button class="btn btn-primary" onclick="delete_account_button()">
                Delete Account
              </button>
              <button class="btn btn-primary" onclick="new_password()">
                Change Password
              </button>
            </h3>
          </div>
        </div>
      </div>
    </body>
</html>